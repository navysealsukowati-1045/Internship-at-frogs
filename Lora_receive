#include <Arduino.h>
#include <RadioLib.h>

// Pin mapping LilyGo T3-S3 SX1262
#define NSS    7
#define RST    8
#define DIO1   33
#define BUSY   34
#define SCK    5
#define MISO   3
#define MOSI   6

SPIClass spiLoRa(HSPI);
SX1262 radio = new Module(NSS, DIO1, RST, BUSY, spiLoRa);

void setup() {
  Serial.begin(115200);
  delay(1500);
  Serial.println("LoRa Receiver - LilyGo T3-S3");

  spiLoRa.begin(SCK, MISO, MOSI, NSS);

  int state = radio.begin();
  if (state != RADIOLIB_ERR_NONE) {
    Serial.print("LoRa init failed, code ");
    Serial.println(state);
    while (true);
  }
  Serial.println("LoRa init success!");
}

void loop() {
  String str;
  int state = radio.receive(str);

  if (state == RADIOLIB_ERR_NONE) {
    Serial.print("Received: ");
    Serial.println(str);
  }
}
